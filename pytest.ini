[pytest]
# PawGate Test Configuration
# WHY: Centralized pytest settings ensure consistent test behavior across
# different environments and developer machines.

# Test Discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Timeout Protection
# WHY: Webcam capture and ML inference can hang indefinitely if hardware
# or drivers misbehave. 10 second timeout prevents CI/CD pipeline stalls.
timeout = 10

# Coverage Reporting
# WHY: Only measure coverage for our source code, not third-party libs.
addopts =
    --cov=src
    --cov-report=term-missing
    --strict-markers
    -v

# Test Markers
# WHY: Categorize tests by scope/speed to enable selective execution.
# Examples:
#   pytest -m smoke          # Quick sanity checks only
#   pytest -m "not integration"  # Skip slow integration tests
markers =
    smoke: Quick sanity checks that run in <1 second
    unit: Isolated unit tests with all dependencies mocked
    integration: Tests that interact with real hardware/OS (webcam, Windows APIs)
    slow: Tests that take >3 seconds (full detection pipeline)

# Logging
# WHY: Show logs on test failures to aid debugging, but keep
# successful test output clean.
log_cli = false
log_cli_level = INFO
log_file = tests/test_run.log
log_file_level = DEBUG

# Warnings
# WHY: Treat warnings as errors during testing to catch deprecations
# and potential issues early.
filterwarnings =
    error
    ignore::DeprecationWarning:pystray.*
    ignore::DeprecationWarning:plyer.*
